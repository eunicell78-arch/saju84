"""
12운성(十二運星) 계산 모듈
12 Life Cycles Calculation Module
"""

# 12운성 순서: 장생, 목욕, 관대, 건록, 제왕, 쇠, 병, 사, 묘, 절, 태, 양

# 일간별 12운성 배치
# 양간(甲丙戊庚壬)은 양지에서 장생, 음간(乙丁己辛癸)은 음지에서 장생
TWELVE_UNSUNG = {
    '甲': {
        '亥': '장생', '子': '목욕', '丑': '관대', '寅': '건록', '卯': '제왕', '辰': '쇠',
        '巳': '병', '午': '사', '未': '묘', '申': '절', '酉': '태', '戌': '양'
    },
    '乙': {
        '午': '장생', '巳': '목욕', '辰': '관대', '卯': '건록', '寅': '제왕', '丑': '쇠',
        '子': '병', '亥': '사', '戌': '묘', '酉': '절', '申': '태', '未': '양'
    },
    '丙': {
        '寅': '장생', '卯': '목욕', '辰': '관대', '巳': '건록', '午': '제왕', '未': '쇠',
        '申': '병', '酉': '사', '戌': '묘', '亥': '절', '子': '태', '丑': '양'
    },
    '丁': {
        '酉': '장생', '申': '목욕', '未': '관대', '午': '건록', '巳': '제왕', '辰': '쇠',
        '卯': '병', '寅': '사', '丑': '묘', '子': '절', '亥': '태', '戌': '양'
    },
    '戊': {
        '寅': '장생', '卯': '목욕', '辰': '관대', '巳': '건록', '午': '제왕', '未': '쇠',
        '申': '병', '酉': '사', '戌': '묘', '亥': '절', '子': '태', '丑': '양'
    },
    '己': {
        '酉': '장생', '申': '목욕', '未': '관대', '午': '건록', '巳': '제왕', '辰': '쇠',
        '卯': '병', '寅': '사', '丑': '묘', '子': '절', '亥': '태', '戌': '양'
    },
    '庚': {
        '巳': '장생', '午': '목욕', '未': '관대', '申': '건록', '酉': '제왕', '戌': '쇠',
        '亥': '병', '子': '사', '丑': '묘', '寅': '절', '卯': '태', '辰': '양'
    },
    '辛': {
        '子': '장생', '亥': '목욕', '戌': '관대', '酉': '건록', '申': '제왕', '未': '쇠',
        '午': '병', '巳': '사', '辰': '묘', '卯': '절', '寅': '태', '丑': '양'
    },
    '壬': {
        '申': '장생', '酉': '목욕', '戌': '관대', '亥': '건록', '子': '제왕', '丑': '쇠',
        '寅': '병', '卯': '사', '辰': '묘', '巳': '절', '午': '태', '未': '양'
    },
    '癸': {
        '卯': '장생', '寅': '목욕', '丑': '관대', '子': '건록', '亥': '제왕', '戌': '쇠',
        '酉': '병', '申': '사', '未': '묘', '午': '절', '巳': '태', '辰': '양'
    }
}


def get_unsung(day_stem_hanja: str, branch_hanja: str) -> str:
    """
    일간 기준으로 지지의 12운성을 계산
    
    Args:
        day_stem_hanja: 일간 한자 (예: '丁')
        branch_hanja: 지지 한자 (예: '未')
    
    Returns:
        12운성 이름 (예: '묘')
    """
    if day_stem_hanja not in TWELVE_UNSUNG:
        return '기타'
    
    unsung_map = TWELVE_UNSUNG[day_stem_hanja]
    return unsung_map.get(branch_hanja, '기타')


def get_unsung_strength(unsung: str) -> str:
    """
    12운성의 강약 분류
    
    Returns:
        '강', '중', '약' 중 하나
    """
    strong = ['장생', '건록', '제왕', '관대']
    medium = ['목욕', '쇠', '양']
    weak = ['병', '사', '묘', '절', '태']
    
    if unsung in strong:
        return '강'
    elif unsung in medium:
        return '중'
    elif unsung in weak:
        return '약'
    else:
        return '중'


def get_unsung_description(unsung: str) -> str:
    """
    12운성의 의미 설명
    """
    descriptions = {
        '장생': '새로운 시작, 성장의 기운',
        '목욕': '변화와 정화, 감성적',
        '관대': '성장과 발전, 활동력',
        '건록': '왕성한 활동, 자립',
        '제왕': '최고의 기운, 권위',
        '쇠': '쇠퇴의 시작, 안정 추구',
        '병': '병약함, 신중함 필요',
        '사': '죽음, 끝과 새 시작 준비',
        '묘': '무덤, 저장과 축적',
        '절': '단절, 고립, 재기 준비',
        '태': '태아, 새로운 구상',
        '양': '양육, 계획과 준비'
    }
    return descriptions.get(unsung, '기타')
